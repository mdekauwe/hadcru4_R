       ylab("Temperature anomaly (1961-1990; deg C)") +
       theme(aspect.ratio=golden_ratio)
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
url <- "http://www.metoffice.gov.uk/hadobs/hadcrut4/data/current/" + "
       "time_series/HadCRUT.4.4.0.0.annual_ns_avg.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab("Temperature anomaly (1961-1990; deg C)") +
       theme(aspect.ratio=golden_ratio) +
       stat_smooth(method="gam", formula=y~s(x), size=1)
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(degree~C)) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(1961-1990)~degree~C)) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~(1961-1990))) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C;~1961-1990))) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C~;1961-1990))) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C~1961-1990))) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C,~1961-1990))) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C~,~1961-1990))) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~,~1961-1990))) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990))) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
m1 <- gamm(temp~s(year, k=20), data=cru)
summary(m1$gam)
m1 <- gamm(temp~s(year, k=10), data=cru)
summary(m1$gam)
m1 <- gamm(temp~s(year, k=5), data=cru)
summary(m1$gam)
m1 <- gam(temp~s(year, k=10), data=cru)
summary(m1)
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
g <- gam(temp~s(year, k=10), data=cru)
summary(g)
plot(g)
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       #stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
g <- gam(temp~s(year, k=10), data=cru)
summary(g)
plot(g)
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
g <- gam(temp~s(year, k=10), data=cru)
summary(g)
plot(g)
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       #stat_smooth(method="gam", formula=y~s(x), size=1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x, bs="cs", k=3)) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x, bs="cs", k=1)) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x, k=1)) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x), size=3) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x), size=0.1) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x), size=1.0) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x), size=0.7) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x), k=3, size=0.7) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x, k=100), size=0.7) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
#!/usr/bin/Rscript
library("ggplot2")
require(mgcv)
golden_ratio <- 1.0 / 1.6180339887
fn <- "HadCRUT_data.txt"
cru <- read.table(url, fill=TRUE)
# drop the other cols
cru <- cru[c(1,2)]
names(cru)[1] <- "year"
names(cru)[2] <- "temp"
ggplot(cru, aes(year, temp)) +
       geom_point(size=0.8) +
       xlab("Year") +
       ylab(expression(Temperature~anomaly~(~degree~C)~1961-1990)) +
       stat_smooth(method="gam", formula=y~s(x, k=20), size=0.7) +
       theme_bw() +
       theme(aspect.ratio=golden_ratio,
             panel.grid.major=element_blank(),
             panel.grid.minor=element_blank())
             panel.grid.minor=element_blank())
